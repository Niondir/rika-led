<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8">
<title>RIKA_Lampe: C:/Dokumente und Einstellungen/Vince/Desktop/RIKA2/software/Lampe/main.c File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css">
<link href="doxygen.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.5.8 -->
<div class="navigation" id="top">
  <div class="tabs">
    <ul>
      <li><a href="index.html"><span>Main&nbsp;Page</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
    </ul>
  </div>
  <div class="tabs">
    <ul>
      <li><a href="files.html"><span>File&nbsp;List</span></a></li>
      <li><a href="globals.html"><span>Globals</span></a></li>
    </ul>
  </div>
</div>
<div class="contents">
<h1>C:/Dokumente und Einstellungen/Vince/Desktop/RIKA2/software/Lampe/main.c File Reference</h1>Main Code.  
<a href="#_details">More...</a>
<p>
<code>#include &lt;avr/io.h&gt;</code><br>
<code>#include &lt;avr/interrupt.h&gt;</code><br>
<code>#include &lt;util/delay.h&gt;</code><br>
<code>#include &lt;stdlib.h&gt;</code><br>
<code>#include &lt;stdio.h&gt;</code><br>
<code>#include &lt;string.h&gt;</code><br>
<code>#include &quot;main.h&quot;</code><br>
<table border="0" cellpadding="0" cellspacing="0">
<tr><td></td></tr>
<tr><td colspan="2"><br><h2>Functions</h2></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="main_8c.html#dd2d7cdddfb682dcc0391e60cf42c7d6">ISR</a> (TIMER0_OVF_vect)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">decreases delaycounters  <a href="#dd2d7cdddfb682dcc0391e60cf42c7d6"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="68f52df99eb21e6ef4cf3dbcf0527f97"></a><!-- doxytag: member="main.c::ISR" ref="68f52df99eb21e6ef4cf3dbcf0527f97" args="(USART_RXC_vect)" -->
&nbsp;</td><td class="memItemRight" valign="bottom"><b>ISR</b> (USART_RXC_vect)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="main_8c.html#28d73ed4fcef46d04166e6461ab482dd">clear_buffers</a> ()</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">clears buffers  <a href="#28d73ed4fcef46d04166e6461ab482dd"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="main_8c.html#cfe700b61af1d0511bcd51aeaefd5971">init_timer_delays</a> ()</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">init timer delays  <a href="#cfe700b61af1d0511bcd51aeaefd5971"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="main_8c.html#824e59d7c038958beb5c4e9de4f79619">init_lamp</a> ()</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">init lamp  <a href="#824e59d7c038958beb5c4e9de4f79619"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="main_8c.html#624228fb06eeb854d2ff6608da386037">insert_default_ad</a> ()</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">inserts default ad  <a href="#624228fb06eeb854d2ff6608da386037"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="main_8c.html#48cfac319595d7680879d96c84e328a2">get_csum_index</a> ()</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">gets csum index  <a href="#48cfac319595d7680879d96c84e328a2"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="main_8c.html#0c51541145489dab6cd2297fea607f6e">calculate_csum</a> (int csumindex, char *buffer)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">calculates checksum  <a href="#0c51541145489dab6cd2297fea607f6e"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="main_8c.html#20595d59ba33e523b9583168dba26df3">checksum_failed</a> ()</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">checks if checksum is wrong  <a href="#20595d59ba33e523b9583168dba26df3"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="main_8c.html#cda5b07ac43c75a677d7a77d829b150a">copy_argument</a> (int rcv_buf_pos, char *dest_array)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">copies argument from rcvbuf to destination  <a href="#cda5b07ac43c75a677d7a77d829b150a"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="main_8c.html#827eb4f99f9b1691f01edd7f5fee2486">change_lamp_id</a> ()</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">changes lamp id  <a href="#827eb4f99f9b1691f01edd7f5fee2486"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="main_8c.html#79153bc7012d22399cf710eb467b006a">set_send_trace</a> ()</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">toggles if lamp sends send_trace packets  <a href="#79153bc7012d22399cf710eb467b006a"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="main_8c.html#b7c2a1919b485f1ffa2790b27f0fcd2e">calculate_overwriteslot</a> ()</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">calculates next pricetag buffer slot to overwrite  <a href="#b7c2a1919b485f1ffa2790b27f0fcd2e"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="main_8c.html#35b14c957b8fefb4a34e7c750f35bc54">forward_packet</a> ()</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">forwards packet saved in the receive buffer  <a href="#35b14c957b8fefb4a34e7c750f35bc54"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="main_8c.html#b7b0bf68c7d38ad9736e9a6470d58f3a">insert_in_ad_buffer</a> (char *source)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">inserts ad in ad buffer  <a href="#b7b0bf68c7d38ad9736e9a6470d58f3a"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="main_8c.html#3ab2c478999cc7a0259f2c533c51b111">insert_in_pricetag_buffer</a> (char *source)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">inserts price tag in price tag buffer  <a href="#3ab2c478999cc7a0259f2c533c51b111"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="main_8c.html#83187070ad1d41f7f700f75415d7d3ee">send_packet</a> (char *packet)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">sends packet via uart  <a href="#83187070ad1d41f7f700f75415d7d3ee"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="main_8c.html#a55d7b616436b64aef6f51137f1f9524">process_packet</a> ()</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">processes packet in buffer  <a href="#a55d7b616436b64aef6f51137f1f9524"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="main_8c.html#33616d0a4488978744cfbf7c5dac5c52">send_next_price_tag</a> ()</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">sends next price tag  <a href="#33616d0a4488978744cfbf7c5dac5c52"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="main_8c.html#2f1e7c4346d2dabf60a5192ef0356e3d">send_next_ad</a> ()</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">sends next ad  <a href="#2f1e7c4346d2dabf60a5192ef0356e3d"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="main_8c.html#840291bc02cba5474a4cb46a9b9566fe">main</a> (void)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">main function  <a href="#840291bc02cba5474a4cb46a9b9566fe"></a><br></td></tr>
<tr><td colspan="2"><br><h2>Variables</h2></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">char&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="main_8c.html#ccf3ca279ca94a9fd23f9ad0125fbe1b">tempstring</a> [120]</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="7b81ba846f2825d6f9c22525f2f7ef80"></a><!-- doxytag: member="main.c::tempchar" ref="7b81ba846f2825d6f9c22525f2f7ef80" args="" -->
char&nbsp;</td><td class="memItemRight" valign="bottom"><b>tempchar</b></td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="b9cb9ec9a7d8d3488821dbb0bf0d2cf7"></a><!-- doxytag: member="main.c::lamp_id" ref="b9cb9ec9a7d8d3488821dbb0bf0d2cf7" args="[5]" -->
char&nbsp;</td><td class="memItemRight" valign="bottom"><b>lamp_id</b> [5]</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="3b3e66234ed4eca16e463a7f73157725"></a><!-- doxytag: member="main.c::send_trace_packet" ref="3b3e66234ed4eca16e463a7f73157725" args="[30]" -->
char&nbsp;</td><td class="memItemRight" valign="bottom"><b>send_trace_packet</b> [30]</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="e23c76c433f7daed5d5f61e6d722a7ca"></a><!-- doxytag: member="main.c::csum" ref="e23c76c433f7daed5d5f61e6d722a7ca" args="[7]" -->
char&nbsp;</td><td class="memItemRight" valign="bottom"><b>csum</b> [7]</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="d90b759d8ed31730f75c737111a2bd45"></a><!-- doxytag: member="main.c::rcv_buf" ref="d90b759d8ed31730f75c737111a2bd45" args="[RCV_BUF_SIZE]" -->
char&nbsp;</td><td class="memItemRight" valign="bottom"><b>rcv_buf</b> [RCV_BUF_SIZE] = &quot;\0&quot;</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="f301437e5574a084af12e386e479928d"></a><!-- doxytag: member="main.c::rcv_buf_iterator" ref="f301437e5574a084af12e386e479928d" args="" -->
int&nbsp;</td><td class="memItemRight" valign="bottom"><b>rcv_buf_iterator</b> = 0</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="805ec151644af63c2f058dcbcbc6c4d6"></a><!-- doxytag: member="main.c::rcv_buf_receiving" ref="805ec151644af63c2f058dcbcbc6c4d6" args="" -->
int&nbsp;</td><td class="memItemRight" valign="bottom"><b>rcv_buf_receiving</b> = FALSE</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="7381483e0246c66e282d6440f762224d"></a><!-- doxytag: member="main.c::rcv_buf_invalid" ref="7381483e0246c66e282d6440f762224d" args="" -->
int&nbsp;</td><td class="memItemRight" valign="bottom"><b>rcv_buf_invalid</b> = FALSE</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="d1bbe1b67a1f6a75a4e535c425c0bf3f"></a><!-- doxytag: member="main.c::packet_received" ref="d1bbe1b67a1f6a75a4e535c425c0bf3f" args="" -->
int&nbsp;</td><td class="memItemRight" valign="bottom"><b>packet_received</b> = FALSE</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="5763065e775af2e98d83c1f235f6554e"></a><!-- doxytag: member="main.c::price_tag_buf_empty" ref="5763065e775af2e98d83c1f235f6554e" args="" -->
int&nbsp;</td><td class="memItemRight" valign="bottom"><b>price_tag_buf_empty</b> = TRUE</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="77f8f550dd68ca35cd96117208c05630"></a><!-- doxytag: member="main.c::adbuf_empty" ref="77f8f550dd68ca35cd96117208c05630" args="" -->
int&nbsp;</td><td class="memItemRight" valign="bottom"><b>adbuf_empty</b> = TRUE</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="f9822ebc0fd17953c1a9c457c2a2561e"></a><!-- doxytag: member="main.c::init_mode" ref="f9822ebc0fd17953c1a9c457c2a2561e" args="" -->
int&nbsp;</td><td class="memItemRight" valign="bottom"><b>init_mode</b> = TRUE</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="dad5177bf07d662963853928939d2d3f"></a><!-- doxytag: member="main.c::send_trace_mode" ref="dad5177bf07d662963853928939d2d3f" args="" -->
int&nbsp;</td><td class="memItemRight" valign="bottom"><b>send_trace_mode</b> = FALSE</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="2981b28c72a8dd89e67a2f9270454931"></a><!-- doxytag: member="main.c::price_tag_buf" ref="2981b28c72a8dd89e67a2f9270454931" args="[PRICE_TAG_BUFFER_SLOTS][PRICE_TAG_PACKET_MAX_LENGTH]" -->
char&nbsp;</td><td class="memItemRight" valign="bottom"><b>price_tag_buf</b> [PRICE_TAG_BUFFER_SLOTS][PRICE_TAG_PACKET_MAX_LENGTH]</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="947cf435b6834cd00aaef11b01c74d59"></a><!-- doxytag: member="main.c::next_overwrite_price_tag_buffer_pos" ref="947cf435b6834cd00aaef11b01c74d59" args="" -->
int&nbsp;</td><td class="memItemRight" valign="bottom"><b>next_overwrite_price_tag_buffer_pos</b> = 0</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="d2d18a537bd9ebae278fe151b66dbc67"></a><!-- doxytag: member="main.c::next_outgoing_price_tag" ref="d2d18a537bd9ebae278fe151b66dbc67" args="" -->
int&nbsp;</td><td class="memItemRight" valign="bottom"><b>next_outgoing_price_tag</b> = 0</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="e5ab2f85d1df562de7286e606ac9d242"></a><!-- doxytag: member="main.c::price_tag_buffer_slots_used" ref="e5ab2f85d1df562de7286e606ac9d242" args="" -->
int&nbsp;</td><td class="memItemRight" valign="bottom"><b>price_tag_buffer_slots_used</b> = 0</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="99f3274d00c3f817bb1b9fede80b9407"></a><!-- doxytag: member="main.c::ad_buffer" ref="99f3274d00c3f817bb1b9fede80b9407" args="[AD_BUFFER_SLOTS][AD_PACKET_MAX_LENGTH]" -->
char&nbsp;</td><td class="memItemRight" valign="bottom"><b>ad_buffer</b> [AD_BUFFER_SLOTS][AD_PACKET_MAX_LENGTH]</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="51b27ff8f8ede384b37ef509462d75f1"></a><!-- doxytag: member="main.c::next_overwrite_ad_buffer_pos" ref="51b27ff8f8ede384b37ef509462d75f1" args="" -->
int&nbsp;</td><td class="memItemRight" valign="bottom"><b>next_overwrite_ad_buffer_pos</b> = 0</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="087f226dc6280465c86f92b6874193e8"></a><!-- doxytag: member="main.c::next_outgoing_ad" ref="087f226dc6280465c86f92b6874193e8" args="" -->
int&nbsp;</td><td class="memItemRight" valign="bottom"><b>next_outgoing_ad</b> = 0</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="745aad58fbe998f5e49e458b1d837108"></a><!-- doxytag: member="main.c::ad_buffer_slots_used" ref="745aad58fbe998f5e49e458b1d837108" args="" -->
int&nbsp;</td><td class="memItemRight" valign="bottom"><b>ad_buffer_slots_used</b> = 0</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="41aaf407dd3ba037945d21271da69cc8"></a><!-- doxytag: member="main.c::ad_delay" ref="41aaf407dd3ba037945d21271da69cc8" args="" -->
int&nbsp;</td><td class="memItemRight" valign="bottom"><b>ad_delay</b></td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="4c5971ca64a9982a7a8aae2e3a3b6833"></a><!-- doxytag: member="main.c::price_tag_delay" ref="4c5971ca64a9982a7a8aae2e3a3b6833" args="" -->
int&nbsp;</td><td class="memItemRight" valign="bottom"><b>price_tag_delay</b></td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="b8a7adb90918680fe7dd0d20cde8ea01"></a><!-- doxytag: member="main.c::send_trace_delay" ref="b8a7adb90918680fe7dd0d20cde8ea01" args="" -->
int&nbsp;</td><td class="memItemRight" valign="bottom"><b>send_trace_delay</b></td></tr>

</table>
<hr><a name="_details"></a><h2>Detailed Description</h2>
Main Code. 
<p>
Contains most of the lamp code <hr><h2>Function Documentation</h2>
<a class="anchor" name="0c51541145489dab6cd2297fea607f6e"></a><!-- doxytag: member="main.c::calculate_csum" ref="0c51541145489dab6cd2297fea607f6e" args="(int csumindex, char *buffer)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void calculate_csum           </td>
          <td>(</td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>csumindex</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char *&nbsp;</td>
          <td class="paramname"> <em>buffer</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
calculates checksum 
<p>
This function calculates the checksum by adding the ascii values of all characters of the packet in the target buffer exept '&lt;' '&gt;' and the checksum itself and saves result in csum[]<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>csumindex</em>&nbsp;</td><td>index of checksum in receivebufferarray </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>buffer</em>&nbsp;</td><td>buffer containing the packet </td></tr>
  </table>
</dl>

</div>
</div><p>
<a class="anchor" name="b7c2a1919b485f1ffa2790b27f0fcd2e"></a><!-- doxytag: member="main.c::calculate_overwriteslot" ref="b7c2a1919b485f1ffa2790b27f0fcd2e" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int calculate_overwriteslot           </td>
          <td>(</td>
          <td class="paramname">          </td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
calculates next pricetag buffer slot to overwrite 
<p>
This function calculates the next slot to be used in the pricetag buffer by comparing the target id of the new price tag packet with the existing ids in the price tag buffer. If the target id exists the new packet will replace the existing one. If not the "next_overwrite_price_tag_buffer_pos" will be used.<p>
<dl class="return" compact><dt><b>Returns:</b></dt><dd>the next price tag slot to overwrite </dd></dl>

</div>
</div><p>
<a class="anchor" name="827eb4f99f9b1691f01edd7f5fee2486"></a><!-- doxytag: member="main.c::change_lamp_id" ref="827eb4f99f9b1691f01edd7f5fee2486" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void change_lamp_id           </td>
          <td>(</td>
          <td class="paramname">          </td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
changes lamp id 
<p>
This Function changes the lamp id in the XBee module as well as in lamp_id[] 
</div>
</div><p>
<a class="anchor" name="20595d59ba33e523b9583168dba26df3"></a><!-- doxytag: member="main.c::checksum_failed" ref="20595d59ba33e523b9583168dba26df3" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int checksum_failed           </td>
          <td>(</td>
          <td class="paramname">          </td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
checks if checksum is wrong 
<p>
This Function compares the recieved and the calculated checksum. It returns 0 if the checksum is correct.<p>
<dl class="return" compact><dt><b>Returns:</b></dt><dd>Status-Code </dd></dl>

</div>
</div><p>
<a class="anchor" name="28d73ed4fcef46d04166e6461ab482dd"></a><!-- doxytag: member="main.c::clear_buffers" ref="28d73ed4fcef46d04166e6461ab482dd" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void clear_buffers           </td>
          <td>(</td>
          <td class="paramname">          </td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
clears buffers 
<p>
*************************************************** FUNCTIONS ****** resets ad buffer and price tag buffer 
</div>
</div><p>
<a class="anchor" name="cda5b07ac43c75a677d7a77d829b150a"></a><!-- doxytag: member="main.c::copy_argument" ref="cda5b07ac43c75a677d7a77d829b150a" args="(int rcv_buf_pos, char *dest_array)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void copy_argument           </td>
          <td>(</td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>rcv_buf_pos</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char *&nbsp;</td>
          <td class="paramname"> <em>dest_array</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
copies argument from rcvbuf to destination 
<p>
This function copies an argument of the packet in the recieve buffer to the selected destination character array.<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>rcv_buf_pos</em>&nbsp;</td><td>the starting position of the argument in the recievebuffer </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>dest_array</em>&nbsp;</td><td>pointer pointing on the destination array </td></tr>
  </table>
</dl>

</div>
</div><p>
<a class="anchor" name="35b14c957b8fefb4a34e7c750f35bc54"></a><!-- doxytag: member="main.c::forward_packet" ref="35b14c957b8fefb4a34e7c750f35bc54" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void forward_packet           </td>
          <td>(</td>
          <td class="paramname">          </td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
forwards packet saved in the receive buffer 
<p>
This function sends the packet in the receive buffer. 
</div>
</div><p>
<a class="anchor" name="48cfac319595d7680879d96c84e328a2"></a><!-- doxytag: member="main.c::get_csum_index" ref="48cfac319595d7680879d96c84e328a2" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int get_csum_index           </td>
          <td>(</td>
          <td class="paramname">          </td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
gets csum index 
<p>
This function searches the location of the checksum in the recieve buffer array.<p>
<dl class="return" compact><dt><b>Returns:</b></dt><dd>index of checksum in receivebuffer </dd></dl>

</div>
</div><p>
<a class="anchor" name="824e59d7c038958beb5c4e9de4f79619"></a><!-- doxytag: member="main.c::init_lamp" ref="824e59d7c038958beb5c4e9de4f79619" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void init_lamp           </td>
          <td>(</td>
          <td class="paramname">          </td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
init lamp 
<p>
This function configures the XBee module to send debug messages to the proper target ID. Afer that it gets the personal MY ID from the module and saves it in lamp_id[]. 
</div>
</div><p>
<a class="anchor" name="cfe700b61af1d0511bcd51aeaefd5971"></a><!-- doxytag: member="main.c::init_timer_delays" ref="cfe700b61af1d0511bcd51aeaefd5971" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void init_timer_delays           </td>
          <td>(</td>
          <td class="paramname">          </td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
init timer delays 
<p>
initializes delays for outgoing packets 
</div>
</div><p>
<a class="anchor" name="624228fb06eeb854d2ff6608da386037"></a><!-- doxytag: member="main.c::insert_default_ad" ref="624228fb06eeb854d2ff6608da386037" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void insert_default_ad           </td>
          <td>(</td>
          <td class="paramname">          </td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
inserts default ad 
<p>
This Function creates a default ad that will be sent until a real advertisement is received. That ensures the traces will work evan if a region got no specific advertisement for a certain time. 
</div>
</div><p>
<a class="anchor" name="b7b0bf68c7d38ad9736e9a6470d58f3a"></a><!-- doxytag: member="main.c::insert_in_ad_buffer" ref="b7b0bf68c7d38ad9736e9a6470d58f3a" args="(char *source)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void insert_in_ad_buffer           </td>
          <td>(</td>
          <td class="paramtype">char *&nbsp;</td>
          <td class="paramname"> <em>source</em>          </td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
inserts ad in ad buffer 
<p>
This function could cycle through different ads. This will not be uses because advertisements per region (and so the buffer) got reduced to one.<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>source</em>&nbsp;</td><td>pointer to the packet that should be inserted in the buffer </td></tr>
  </table>
</dl>

</div>
</div><p>
<a class="anchor" name="3ab2c478999cc7a0259f2c533c51b111"></a><!-- doxytag: member="main.c::insert_in_pricetag_buffer" ref="3ab2c478999cc7a0259f2c533c51b111" args="(char *source)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void insert_in_pricetag_buffer           </td>
          <td>(</td>
          <td class="paramtype">char *&nbsp;</td>
          <td class="paramname"> <em>source</em>          </td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
inserts price tag in price tag buffer 
<p>
This function inserts new price tag packets to the price tag buffer. If the price tag already exists it will be replaced.<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>source</em>&nbsp;</td><td>pointer to the packet that should be inserted in the buffer </td></tr>
  </table>
</dl>

</div>
</div><p>
<a class="anchor" name="dd2d7cdddfb682dcc0391e60cf42c7d6"></a><!-- doxytag: member="main.c::ISR" ref="dd2d7cdddfb682dcc0391e60cf42c7d6" args="(TIMER0_OVF_vect)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">ISR           </td>
          <td>(</td>
          <td class="paramtype">TIMER0_OVF_vect&nbsp;</td>
          <td class="paramname">          </td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
decreases delaycounters 
<p>
*************************************************** INTERRUPT SERVICE ROUTINES ************* when timer0 overflow occurs the delay timers are deacreased by 1 
</div>
</div><p>
<a class="anchor" name="840291bc02cba5474a4cb46a9b9566fe"></a><!-- doxytag: member="main.c::main" ref="840291bc02cba5474a4cb46a9b9566fe" args="(void)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int main           </td>
          <td>(</td>
          <td class="paramtype">void&nbsp;</td>
          <td class="paramname">          </td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
main function 
<p>
This function first initializes the hardware. After that it goes to an endless main loop. In that loop it reacts to different flags, set by the interrupt service routines. 
<p>
*************************************************** MAIN LOOP *************
</div>
</div><p>
<a class="anchor" name="a55d7b616436b64aef6f51137f1f9524"></a><!-- doxytag: member="main.c::process_packet" ref="a55d7b616436b64aef6f51137f1f9524" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void process_packet           </td>
          <td>(</td>
          <td class="paramname">          </td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
processes packet in buffer 
<p>
After checking for the correct checksum this function analyses the command number of the packet in the receive buffer and executes further steps depending on that number. 
</div>
</div><p>
<a class="anchor" name="2f1e7c4346d2dabf60a5192ef0356e3d"></a><!-- doxytag: member="main.c::send_next_ad" ref="2f1e7c4346d2dabf60a5192ef0356e3d" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void send_next_ad           </td>
          <td>(</td>
          <td class="paramname">          </td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
sends next ad 
<p>
This function sends an ad and determines the next price tag to be sent. After that the delay timer will be reset. 
</div>
</div><p>
<a class="anchor" name="33616d0a4488978744cfbf7c5dac5c52"></a><!-- doxytag: member="main.c::send_next_price_tag" ref="33616d0a4488978744cfbf7c5dac5c52" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void send_next_price_tag           </td>
          <td>(</td>
          <td class="paramname">          </td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
sends next price tag 
<p>
This function sends a price tag and determines the next price tag to be sent. After that the delay timer will be reset. 
</div>
</div><p>
<a class="anchor" name="83187070ad1d41f7f700f75415d7d3ee"></a><!-- doxytag: member="main.c::send_packet" ref="83187070ad1d41f7f700f75415d7d3ee" args="(char *packet)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void send_packet           </td>
          <td>(</td>
          <td class="paramtype">char *&nbsp;</td>
          <td class="paramname"> <em>packet</em>          </td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
sends packet via uart 
<p>
This function sends the packet after adding opening "&lt;" and closing "&gt;" via LEDs. If debug is defined a copy will be sent through Xbee module.<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>packet</em>&nbsp;</td><td>the packet to be sent </td></tr>
  </table>
</dl>

</div>
</div><p>
<a class="anchor" name="79153bc7012d22399cf710eb467b006a"></a><!-- doxytag: member="main.c::set_send_trace" ref="79153bc7012d22399cf710eb467b006a" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void set_send_trace           </td>
          <td>(</td>
          <td class="paramname">          </td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
toggles if lamp sends send_trace packets 
<p>
This function toggles between sending or not sending send trace packets. If the first argument is 0 it stops sending these packets, if 1 the packet with the target id will be copied and sending will be activated 
</div>
</div><p>
<hr><h2>Variable Documentation</h2>
<a class="anchor" name="ccf3ca279ca94a9fd23f9ad0125fbe1b"></a><!-- doxytag: member="main.c::tempstring" ref="ccf3ca279ca94a9fd23f9ad0125fbe1b" args="[120]" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">char <a class="el" href="main_8c.html#ccf3ca279ca94a9fd23f9ad0125fbe1b">tempstring</a>[120]          </td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
*************************************************** INCLUDES ************** *************************************************** GLOBAL VARIABLES ********** 
</div>
</div><p>
</div>
<hr size="1"><address style="text-align: right;"><small>Generated on Thu Feb 12 10:48:38 2009 for RIKA_Lampe by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img src="doxygen.png" alt="doxygen" align="middle" border="0"></a> 1.5.8 </small></address>
</body>
</html>
